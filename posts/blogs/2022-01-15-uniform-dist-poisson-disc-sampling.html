<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="4Y4j9CIooUmnjwIpVMuPbEtO0gQQy1-Q0hymYrw8Yw0"/>
<meta name="description" content="Uniform Random Distribution using Poisson Disc Sampling">
<title>
Uniform Random Distribution using Poisson Disc Sampling
</title>
<link rel="stylesheet" href="https://deep110.github.io/assets/css/main.css">
<script>if(localStorage.getItem("theme")==="dark"){document.documentElement.setAttribute("theme","dark")}</script>
</head>
<body>
<header class="site-header">
<div class="wrapper">
<a href="#" id="menu-icon" aria-label="NavDrawer">
<svg viewBox="0 0 18 15">
<path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
<path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
<path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
</svg>
</a>
<a class="site-title" href="https://deep110.github.io/">Deepankar</a>
<a href="#" id="dark-theme-icon" class="icon" title="Switch to dark theme" aria-label="Toggle Theme">
<svg viewBox="0 0 512 512">
<path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/>
</svg>
</a>
<nav class="site-nav">
<div class="trigger">
<a class="page-link" href="https://deep110.github.io/about.html">About Me</a>
<a class="page-link" href="https://deep110.github.io/archive.html">Archive</a>
<a class="page-link" href="https://deep110.github.io/log.html">Logs</a>
<a class="page-link" href="https://deep110.github.io/projects.html">Projects</a>
</div>
</nav>
</div>
</header>
<div class="page-content">
<div class="wrapper">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
<header class="post-header">
<h1 class="post-title" itemprop="name headline">Uniform Random Distribution using Poisson Disc Sampling</h1>
<p class="post-meta">
<time datetime="2022-01-15 00:00:00 +0000" itemprop="datePublished">
Jan 15, 2022
</time>
| <span class="time">
9
</span>
Minute Read
</p>
</header>
<div class="post-content" itemprop="articleBody">
<div id="canvas-container">
<canvas id="canvas" height=500 width=740></canvas>
<div id="controls-container">
<div class="slider-container">
<label for="myRadius">MinDistance</label>
<input type="range" min="5" max="25" value="10" class="slider" id="myRadius">
</div>
<div class="slider-container">
<label for="myMaxTries">MaxTries</label>
<input type="range" min="1" max="20" value="10" class="slider" id="myMaxTries">
</div>
</div>
</div>
<style>canvas{background:#3a3a3a;display:block;margin:auto;cursor:pointer;}.slider-container{display:flex;margin-top:30px;}.slider{-webkit-appearance:none;appearance:none;width:100%;height:20px;border-radius:5px;background:#d3d3d3;margin-left:5%;outline:none;opacity:0.7;-webkit-transition:.2s;transition:opacity .2s;}.slider:hover{opacity:1;}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:30px;height:30px;background:#515865;cursor:pointer;}.slider::-moz-range-thumb{width:30px;height:30px;background:#515865;cursor:pointer;}@media only screen and (max-width:740px){canvas{width:calc(100vw - 2em);}#canvas-container{width:calc(100vw - 2em);}}</style>
<br>
<p>Suppose you want to fill a texture or a 3D world with a object placed randomly like procedurally filling a forest with trees, random 2D distribution does not give good results.</p>
<div style="text-align:center">
<img src="/assets/images/2022-01/random-sampling-vs-poisson-sampling.jpg" alt="Random Sampling vs Poisson Disc Sampling"></img>
<div style="margin-top: 8px;">Random Sampling vs Poisson Disc Sampling</div>
</div>
<br>
<p>Poisson Disc Sampling has many applications in games:</p>
<ul>
<li>uniform random object placement</li>
<li>sampling for graphics applications</li>
<li>procedural texture algorithms</li>
<li>mesh algorithms</li>
</ul>
<p>The one i would be focusing on is object placement.</p>
<h3>Implementation</h3>
<p>There are many implementations for poisson disc sampling but the one we are going to discuss was proposed by <a href="#references">Robert Bridson</a>. It is reasonably fast and can be used for N arbitrary dimensions.</p>
<p>The steps are as follows:</p>
<ol>
<li>First we will define the minimum distance <code>r</code> that we want our points to have. Then a 2D grid is created with a cell-size <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1572200000000001em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span></span></span></span> [See the below diagram for why].</li>
</ol>
<div style="text-align:center">
<img src="/assets/images/2022-01/grid-cell-size.jpg" alt="Grid Cell Size"></img>
<div style="margin-top: 8px;">Calculating Cell Size a</div>
</div>
<br>
<p>Let us then start with declaring some variables:</p>
<pre style="background-color:#fafafa;">
<span style="color:#a626a4;">let </span><span style="color:#383a42;">radius </span><span style="color:#0184bc;">= </span><span style="color:#986801;">10</span><span style="color:#383a42;">;
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">cellSize </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">radius </span><span style="color:#0184bc;">/ </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">sqrt</span><span style="color:#383a42;">(</span><span style="color:#986801;">2</span><span style="color:#383a42;">);
</span><span style="color:#383a42;">
</span><span style="font-style:italic;color:#a0a1a7;">// number of columns and rows grid will have
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">numColumns </span><span style="color:#0184bc;">= </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">floor</span><span style="color:#383a42;">(</span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.width </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">cellSize);
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">numRows </span><span style="color:#0184bc;">= </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">floor</span><span style="color:#383a42;">(</span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.height </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">cellSize);
</span><span style="color:#383a42;">
</span><span style="font-style:italic;color:#a0a1a7;">// initialize grid
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">grid </span><span style="color:#0184bc;">= new </span><span style="color:#c18401;">Array</span><span style="color:#383a42;">(numColumns </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">numRows);
</span><span style="color:#e45649;">grid</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">fill</span><span style="color:#383a42;">(</span><span style="color:#986801;">undefined</span><span style="color:#383a42;">);
</span></pre>
<ol start="2">
<li>Next choose a random starting point in the 2D space. We will also define a variable <code>activeList</code> which will contain points which we still need to process. Put the startPoint in the grid as well as in <code>activeList</code>.</li>
</ol>
<p>In my simulation starting point is either canvas center or the mouse click position. Points in pink color are the ones present in activeList.</p>
<pre style="background-color:#fafafa;">
<span style="font-style:italic;color:#a0a1a7;">// ...
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">activeList </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">[];
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">main</span><span style="color:#383a42;">() {
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">var </span><span style="color:#383a42;">startPoint </span><span style="color:#0184bc;">= new </span><span style="color:#e45649;">Vector2</span><span style="color:#383a42;">(</span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.width </span><span style="color:#0184bc;">/ </span><span style="color:#986801;">2</span><span style="color:#383a42;">, </span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.height </span><span style="color:#0184bc;">/ </span><span style="color:#986801;">2</span><span style="color:#383a42;">);
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">var </span><span style="color:#383a42;">[si, sj] </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">toGrid</span><span style="color:#383a42;">(startPoint);
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">  </span><span style="font-style:italic;color:#a0a1a7;">// put the start point in grid and active list
</span><span style="color:#383a42;">  </span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[sj </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">si </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">numColumns] </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">startPoint;
</span><span style="color:#383a42;">  </span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">push</span><span style="color:#383a42;">(startPoint);
</span><span style="color:#383a42;">}
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">toGrid</span><span style="color:#383a42;">(v) {
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">return </span><span style="color:#383a42;">[</span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">floor</span><span style="color:#383a42;">(</span><span style="color:#e45649;">v</span><span style="color:#383a42;">.y </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">cellSize), </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">floor</span><span style="color:#383a42;">(</span><span style="color:#e45649;">v</span><span style="color:#383a42;">.x </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">cellSize)];
</span><span style="color:#383a42;">}
</span></pre>
<ol start="3">
<li>Repeat the below steps until <code>activeList</code> is not empty:</li>
</ol>
<ul>
<li>Choose a random point from the activeList</li>
<li>Generate k points [max tries in my simulation] randomly from an annulus [min distance r and max distance 2r].</li>
</ul>
<div style="text-align:center">
<img src="/assets/images/2022-01/sampling-annulus.jpg" alt="Poisson Disc Sampling Annulus"></img>
</div>
<br>
<ul>
<li>For each generated point check if point already exists in grid at that position or if it is too close [&lt; r] to any point. You need not check the whole grid, just checking the neighboring cells would work.</li>
<li>If there is none, add this point to activeList and grid.</li>
<li>If no new point is found, remove the current point from the activeList.</li>
</ul>
<pre style="background-color:#fafafa;">
<span style="font-style:italic;color:#a0a1a7;">// ...
</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">maxTryLimit </span><span style="color:#0184bc;">= </span><span style="color:#986801;">10</span><span style="color:#383a42;">;
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">main</span><span style="color:#383a42;">() {
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">var </span><span style="color:#383a42;">startPoint </span><span style="color:#0184bc;">= new </span><span style="color:#e45649;">Vector2</span><span style="color:#383a42;">(</span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.width </span><span style="color:#0184bc;">/ </span><span style="color:#986801;">2</span><span style="color:#383a42;">, </span><span style="color:#e45649;">canvas</span><span style="color:#383a42;">.height </span><span style="color:#0184bc;">/ </span><span style="color:#986801;">2</span><span style="color:#383a42;">);
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">var </span><span style="color:#383a42;">[si, sj] </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">toGrid</span><span style="color:#383a42;">(startPoint);
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">  </span><span style="font-style:italic;color:#a0a1a7;">// put the start point in grid and active list
</span><span style="color:#383a42;">  </span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[sj </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">si </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">numColumns] </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">startPoint;
</span><span style="color:#383a42;">  </span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">push</span><span style="color:#383a42;">(startPoint);
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">while </span><span style="color:#383a42;">(</span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.length </span><span style="color:#0184bc;">&gt; </span><span style="color:#986801;">0</span><span style="color:#383a42;">) {
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">index </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">MathUtil</span><span style="color:#383a42;">.</span><span style="color:#e45649;">randomInt</span><span style="color:#383a42;">(</span><span style="color:#986801;">0</span><span style="color:#383a42;">, </span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.length);
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">activePoint </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">[index];
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">sample </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">generateSample</span><span style="color:#383a42;">();
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">if </span><span style="color:#383a42;">(sample) {
</span><span style="color:#383a42;">      </span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[sampleGridIndex] </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">sample;
</span><span style="color:#383a42;">			</span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">push</span><span style="color:#383a42;">(sample);
</span><span style="color:#383a42;">    } </span><span style="color:#a626a4;">else </span><span style="color:#383a42;">{
</span><span style="color:#383a42;">      </span><span style="font-style:italic;color:#a0a1a7;">// remove point from active list
</span><span style="color:#383a42;">      </span><span style="color:#e45649;">activeList</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">splice</span><span style="color:#383a42;">(index, </span><span style="color:#986801;">1</span><span style="color:#383a42;">);
</span><span style="color:#383a42;">    }
</span><span style="color:#383a42;">  }
</span><span style="color:#383a42;">}
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">generateSample</span><span style="color:#383a42;">() {
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">for </span><span style="color:#383a42;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">n </span><span style="color:#0184bc;">= </span><span style="color:#986801;">0</span><span style="color:#383a42;">; n </span><span style="color:#0184bc;">&lt; </span><span style="color:#383a42;">maxTryLimit; n</span><span style="color:#0184bc;">++</span><span style="color:#383a42;">) {
</span><span style="color:#383a42;">		</span><span style="font-style:italic;color:#a0a1a7;">// generate a random 2d point between r and 2r radius from active point
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">randomAngle </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">MathUtil</span><span style="color:#383a42;">.</span><span style="color:#e45649;">randomFloat</span><span style="color:#383a42;">(</span><span style="color:#986801;">0</span><span style="color:#383a42;">, </span><span style="color:#986801;">2 </span><span style="color:#0184bc;">* </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.PI);
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">randomDistance </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">MathUtil</span><span style="color:#383a42;">.</span><span style="color:#e45649;">randomInt</span><span style="color:#383a42;">(radius, </span><span style="color:#986801;">2 </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">radius);
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">sample </span><span style="color:#0184bc;">= new </span><span style="color:#e45649;">Vector2</span><span style="color:#383a42;">(
</span><span style="color:#383a42;">      </span><span style="color:#e45649;">activePoint</span><span style="color:#383a42;">.x </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">randomDistance </span><span style="color:#0184bc;">* </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">cos</span><span style="color:#383a42;">(randomAngle),
</span><span style="color:#383a42;">      </span><span style="color:#e45649;">activePoint</span><span style="color:#383a42;">.y </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">randomDistance </span><span style="color:#0184bc;">* </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">sin</span><span style="color:#383a42;">(randomAngle)
</span><span style="color:#383a42;">    );
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">[sampleGridI, sampleGridJ] </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">toGrid</span><span style="color:#383a42;">(sample);
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">sampleGridIndex </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">sampleGridJ </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">sampleGridI </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">numColumns;
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">		</span><span style="font-style:italic;color:#a0a1a7;">// before proceeding check if sample lies inside our boundary and no sample already
</span><span style="color:#383a42;">		</span><span style="font-style:italic;color:#a0a1a7;">// exists in the grid in that position
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">if </span><span style="color:#383a42;">(sampleGridI </span><span style="color:#0184bc;">&lt; </span><span style="color:#986801;">0 </span><span style="color:#0184bc;">|| </span><span style="color:#383a42;">sampleGridJ </span><span style="color:#0184bc;">&lt; </span><span style="color:#986801;">0 </span><span style="color:#0184bc;">|| </span><span style="color:#383a42;">sampleGridI </span><span style="color:#0184bc;">&gt; </span><span style="color:#383a42;">numRows </span><span style="color:#0184bc;">|| </span><span style="color:#383a42;">sampleGridJ </span><span style="color:#0184bc;">&gt; </span><span style="color:#383a42;">numColumns </span><span style="color:#0184bc;">|| </span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[sampleGridIndex]) {
</span><span style="color:#383a42;">			</span><span style="color:#a626a4;">continue</span><span style="color:#383a42;">;
</span><span style="color:#383a42;">		}
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">    </span><span style="font-style:italic;color:#a0a1a7;">// check if point is atleast r distance away from 8 neighboring points
</span><span style="color:#383a42;">		</span><span style="color:#a626a4;">if </span><span style="color:#383a42;">(</span><span style="color:#e45649;">isNeighborOk</span><span style="color:#383a42;">(sampleGridI, sampleGridJ, sample)) {
</span><span style="color:#383a42;">			</span><span style="color:#a626a4;">return </span><span style="color:#383a42;">sample;
</span><span style="color:#383a42;">		}
</span><span style="color:#383a42;">	}
</span><span style="color:#383a42;">}
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">isNeighborOk</span><span style="color:#383a42;">(grid_i, grid_j, sample) {
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">for </span><span style="color:#383a42;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">i </span><span style="color:#0184bc;">= -</span><span style="color:#986801;">1</span><span style="color:#383a42;">; i </span><span style="color:#0184bc;">&lt;= </span><span style="color:#986801;">1</span><span style="color:#383a42;">; i</span><span style="color:#0184bc;">++</span><span style="color:#383a42;">) {
</span><span style="color:#383a42;">    </span><span style="color:#a626a4;">for </span><span style="color:#383a42;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">j </span><span style="color:#0184bc;">= -</span><span style="color:#986801;">1</span><span style="color:#383a42;">; j </span><span style="color:#0184bc;">&lt;= </span><span style="color:#986801;">1</span><span style="color:#383a42;">; j</span><span style="color:#0184bc;">++</span><span style="color:#383a42;">) {
</span><span style="color:#383a42;">      </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">checkingIndex </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">(grid_j </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">j) </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">(grid_i </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">i) </span><span style="color:#0184bc;">* </span><span style="color:#383a42;">numColumns;
</span><span style="color:#383a42;">      </span><span style="color:#a626a4;">if </span><span style="color:#383a42;">(</span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[checkingIndex]) {
</span><span style="color:#383a42;">        </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">distanceSqr </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">Vector2</span><span style="color:#383a42;">.</span><span style="color:#e45649;">distanceSqr</span><span style="color:#383a42;">(sample, </span><span style="color:#e45649;">grid</span><span style="color:#383a42;">[checkingIndex]);
</span><span style="color:#383a42;">        </span><span style="color:#a626a4;">if </span><span style="color:#383a42;">(distanceSqr </span><span style="color:#0184bc;">&lt; </span><span style="color:#383a42;">radiusSqr) {
</span><span style="color:#383a42;">          </span><span style="color:#a626a4;">return </span><span style="color:#986801;">false</span><span style="color:#383a42;">;
</span><span style="color:#383a42;">        }
</span><span style="color:#383a42;">      }
</span><span style="color:#383a42;">    }
</span><span style="color:#383a42;">  }
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">return </span><span style="color:#986801;">true</span><span style="color:#383a42;">;
</span><span style="color:#383a42;">}
</span></pre>
<h3>Effect of Max tries</h3>
<p>Having a greater value of k [typically more than 30] will give you a dense packing while having a less value [&lt; 5] can leave holes in the generation.</p>
<div style="text-align:center">
<img src="/assets/images/2022-01/sampling-less-k.jpg" alt="Poisson Disc Sampling Less Max tries"></img>
</div>
<br>
<p>Though it can be desirable if you would want to fill those areas with some other things. For example with lakes when generating a forest. You can try playing around with <code>MaxTries</code> slider above to see the effect of k.</p>
<h3 id="references">References</h3>
<ol>
<li><a href="https://www.cs.ubc.ca/%7Erbridson/docs/bridson-siggraph07-poissondisk.pdf">Fast Poisson Disk Sampling in Arbitrary Dimensions</a> by Robert Bridson, University of British Columbia</li>
<li><a href="https://en.wikipedia.org/wiki/Supersampling#Poisson_disk">Wikipedia</a></li>
</ol>
</div>
<div class="post-navigation">
<a class="next" href="https://deep110.github.io/posts/blogs/2021-06-26-convex-hull-graham-scan.html">←&nbsp;Prev Post</a>
</div>
<div>
<script src="https://utteranc.es/client.js" repo="deep110/deep110.github.io" issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async></script>
</div>
</article>
</div>
</div>
<footer class="site-footer">
<div class="wrapper">
<a class="footer-icon icon" href="https://github.com/deep110" aria-label="Github">
<svg viewBox="0 0 438.55 438.55">
<path d="m409.13 114.57c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.06-29.408-39.781 0-76.472 9.804-110.06 29.408-33.596 19.605-60.192 46.204-79.8 79.8-19.605 33.595-29.408 70.281-29.408 110.06 0 47.78 13.94 90.745 41.827 128.91 27.884 38.164 63.906 64.572 108.06 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417-.098-9.709-.144-18.179-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289s4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136s11.704-.476 16.274-1.423c4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.07-79.226 27.88-38.161 41.825-81.126 41.825-128.91-.01-39.771-9.818-76.454-29.414-110.05z"/>
</svg>
</a>
<a class="footer-icon icon" href="https://www.linkedin.com/in/deepankar-agrawal-318aab96/" aria-label="LinkedIn">
<svg enable-background="new 0 0 486.392 486.392" version="1.1" viewBox="0 0 486.39 486.39">
<path d="m243.2 0c-134.3 0-243.2 108.89-243.2 243.2s108.89 243.2 243.2 243.2 243.2-108.89 243.2-243.2c0-134.34-108.89-243.2-243.2-243.2zm-60.799 360.99h-60.799v-212.8h60.799v212.8zm-28.515-225.84c-15.747 0-28.484-12.768-28.484-28.515s12.768-28.515 28.484-28.515c15.747 0.03 28.515 12.798 28.515 28.515 0 15.747-12.768 28.515-28.515 28.515zm241.31 225.84h-60.799v-131.57c0-15.413-4.408-26.204-23.347-26.204-31.403 0-37.452 26.204-37.452 26.204v131.57h-60.799v-212.8h60.799v20.337c8.694-6.657 30.399-20.307 60.799-20.307 19.699 0 60.799 11.795 60.799 83.051v129.72z"/>
</svg>
</a>
<a class="footer-icon icon" href="https://deep110.github.io/rss.xml" aria-label="RSS">
<svg viewBox="0 0 48 48">
<path fill-rule="evenodd" clip-rule="evenodd" d="M24 0C10.7452 0 0 10.7452 0 24C0 37.2548 10.7452 48 24 48C37.2548 48 48 37.2548 48 24C48 10.7452 37.2548 0 24 0ZM17.6002 33.6C15.833 33.6 14.4002 32.1672 14.4002 30.4C14.4002 28.6328 15.833 27.2 17.6002 27.2C19.3674 27.2 20.8002 28.6328 20.8002 30.4C20.8002 32.1672 19.3674 33.6 17.6002 33.6ZM36.8 33.6C36.8 21.2488 26.7513 11.2 14.4002 11.2V15.4664C24.3993 15.4664 32.5336 23.6008 32.5336 33.6H36.8ZM14.4 18.6664C22.6343 18.6664 29.3334 25.3656 29.3334 33.6H25.0671C25.0671 27.7184 20.2815 22.9336 14.4 22.9336V18.6664Z"/>
</svg>
</a>
<a class="footer-icon icon" href="mailto:deepankar11093@gmail.com" aria-label="Mail">
<svg enable-background="new 0 0 299.997 299.997" viewBox="0 0 299.997 299.997"><path d="m149.996 0c-82.839 0-149.995 67.158-149.995 149.997 0 82.837 67.156 150 149.995 150s150-67.163 150-150c0-82.839-67.161-149.997-150-149.997zm.003 52.686 88.763 55.35h-177.526zm89.869 143.737h-.009c0 8.878-7.195 16.072-16.072 16.072h-147.576c-8.878 0-16.072-7.195-16.072-16.072v-84.865c0-.939.096-1.852.252-2.749l84.808 52.883c.104.065.215.109.322.169.112.062.226.122.34.179.599.309 1.216.558 1.847.721.065.018.13.026.195.041.692.163 1.393.265 2.093.265h.005.01c.7 0 1.401-.099 2.093-.265.065-.016.13-.023.195-.041.63-.163 1.245-.412 1.847-.721.114-.057.228-.117.34-.179.106-.06.218-.104.322-.169l84.808-52.883c.156.897.252 1.808.252 2.749z"/></svg>
</a>
</div>
</footer>
<script type="text/javascript" src="https://deep110.github.io/assets/js/main.js"></script>
<script type="text/javascript" src="https://deep110.github.io/assets/js/extras/simulate-poisson-disc-sampling.js"></script>
<link rel="stylesheet" href="https://deep110.github.io/assets/css/katex.min.css"></script>
</body>
</html>