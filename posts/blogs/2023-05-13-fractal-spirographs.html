<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="4Y4j9CIooUmnjwIpVMuPbEtO0gQQy1-Q0hymYrw8Yw0"/>
<meta name="description" content="Fractal Spirographs">
<meta name="keywords" content="html5, canvas, marching, fractal, spirograph">
<title>
Fractal Spirographs
</title>
<link rel="stylesheet" href="https://deep110.github.io/assets/css/main.css">
<script>if(localStorage.getItem("theme")==="dark"){document.documentElement.setAttribute("theme","dark")}</script>
</head>
<body>
<header class="site-header">
<div class="wrapper">
<a href="#" id="menu-icon" aria-label="NavDrawer">
<svg viewBox="0 0 18 15">
<path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
<path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
<path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
</svg>
</a>
<a class="site-title" href="https://deep110.github.io/">Deepankar</a>
<a href="#" id="dark-theme-icon" class="icon" title="Switch to dark theme" aria-label="Toggle Theme">
<svg viewBox="0 0 512 512">
<path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/>
</svg>
</a>
<nav class="site-nav">
<div class="trigger">
<a class="page-link" href="https://deep110.github.io/travel.html">Travel Log</a>
<a class="page-link" href="https://deep110.github.io/archive.html">Archive</a>
<a class="page-link" href="https://deep110.github.io/projects.html">Projects</a>
<a class="page-link" href="https://deep110.github.io/about.html">About</a>
</div>
</nav>
</div>
</header>
<div class="page-content">
<div class="wrapper">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
<header class="post-header">
<h1 class="post-title" itemprop="name headline">Fractal Spirographs</h1>
<p class="post-meta">
<time datetime="2023-05-13 00:00:00 +0000" itemprop="datePublished">
May 13, 2023
</time>
| <span class="time">
6
</span>
Minute Read
</p>
</header>
<div class="post-content" itemprop="articleBody">
<p>In a <a href="https://softologyblog.wordpress.com/2017/02/27/fractal-spirographs/">blog post</a> recently, I discovered how to create 2D fractals from spirographs. Intrigued by the possibilities of this technique, I decided to experiment with it further. I found that by controlling just a few variables, I could generate a wide variety of patterns. I hope you enjoy this exploration of a beautiful and complex mathematical concept just like I did.</p>
<div id="canvas-container" style="position: relative;">
<canvas id="canvas-shape" height=700 width=600></canvas>
<canvas id="canvas-circle" height=700 width=600 style="background: black;"></canvas>
<div id="gui-main"></div>
</div>
<br>
<p>You can try to change variables such as <code>RadiusFallOff</code>, <code>RotationSpeed</code>, etc. to get more shapes. Color is added by mapping angle of rotation to HSL space. You can change saturation to give it a grayscale or more colorful look.</p>
<h3>The Setup</h3>
<p><a href="https://wikipedia.org/wiki/Spirograph">Spirograph</a> is a geometric drawing device that produces mathematical roulette curves. But you may know them widely as stencils in shape of gears which we have used in childhood to draw beautiful works of art.</p>
<div style="text-align:center">
<img src="/assets/images/2023-05/spirograph-example-set.webp" alt="Spirograph Example Set" width=350></img>
<div style="margin-top: 8px;">Spirograph Example Set</div>
</div>
<br>
<p>A digital spirograph is created by rotating multiple circles relative to each other and tracing the path of the center of the last circle. It is essentially a simulation of the classic spirograph, which involved rotating a stencil and tracing a point on it to create intricate and repetitive patterns.</p>
<div style="text-align:center">
<img src="/assets/images/2023-05/circles-for-spirograph.webp" alt width=400></img>
<div>Interconnected Circles</div>
</div>
<br>
<p>We can specify the size, position, and rotation speed of each circle to create a wide variety of patterns. There are four major parameters that affects generated pattern:</p>
<ol>
<li><b><u>Number Of Circles</u></b>: As we increase number of circles keeping other factors constant we get more intricate pattern.</li>
</ol>
<div style="text-align:center">
<img src="/assets/images/2023-05/variation-num-circles.webp" alt="Variation Number Of Circles" width=700></img>
</div>
<br>
<ol start="2">
<li><b><u>Rotation Speed</u></b>: Rotation speed is another major parameter that dictates the generated fractal pattern. More the base speed of rotation more detail can be rendered during the same revolution. Not only the speed, direction of rotation also changes the pattern. You can refer the comparison below:</li>
</ol>
<div style="text-align:center">
<img src="/assets/images/2023-05/variation-rotation-speed.webp" alt="Variation Rotation Speed" width=500></img>
</div>
<br>
<p>Rotation Speed of circles are distributed exponentially. So for an i-th circle speed is calculated as:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal">ro</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ee</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.958em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>
where, <em><strong>k</strong></em> = supplied rotation speed</p>
<ol start="3">
<li><u><b>Radius Falloff</u></b>: Radius fall off controls the radius of subsequent circles. For example: If radius fall off is 2 each subsequent circle's radius would be halved. So more the value, smaller would be the details; as you can see the in the figure below:</li>
</ol>
<div style="text-align:center">
<img src="/assets/images/2023-05/variation-radius-fall-off.webp" alt="Variation Radius FallOff" width=700></img>
</div>
<br>
<ol start="4">
<li><u><b>Speed Falloff</u></b>: Speed fall off directly affects rotation speed of a circle along with the provided base speed.</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal">ro</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ee</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1877em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5017em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
where,
<em><strong>k</strong></em> = supplied rotation speed,
<em><strong>sf</strong></em> = supplied speed fall off</p>
<p>More the value of fall off, less would be the speed of rotation, hence more details can be rendered.</p>
<div style="text-align:center">
<img src="/assets/images/2023-05/variation-speed-fall-off.webp" alt="Variation Speed FallOff" width=700></img>
</div>
<br>
<p>Now lets see how we can use the above parameters in code.</p>
<h2>Implementation</h2>
<ol>
<li>First we will define a circle class with some properties.</li>
</ol>
<pre style="background-color:#fafafa;">
<code><span style="color:#a626a4;">class </span><span style="color:#c18401;">Circle {
</span><span style="color:#c18401;">    </span><span style="color:#4078f2;">constructor</span><span style="color:#c18401;">(</span><span style="color:#383a42;">center</span><span style="color:#c18401;">, </span><span style="color:#383a42;">radius</span><span style="color:#c18401;">, </span><span style="color:#383a42;">rotateSpeed</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">center</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">center</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">radius;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">rotateSpeed </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">rotateSpeed;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">angle </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">MathUtil</span><span style="color:#383a42;">.</span><span style="color:#e45649;">toRadian</span><span style="color:#c18401;">(</span><span style="color:#986801;">90</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    }
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">    </span><span style="color:#4078f2;">draw</span><span style="color:#c18401;">(</span><span style="color:#383a42;">ctx</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">beginPath</span><span style="color:#c18401;">()</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">arc</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x</span><span style="color:#383a42;">, </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y</span><span style="color:#383a42;">, </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius</span><span style="color:#383a42;">, </span><span style="color:#986801;">0</span><span style="color:#383a42;">, </span><span style="color:#c18401;">MathUtil</span><span style="color:#383a42;">.</span><span style="color:#c18401;">PI2)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#c18401;">strokeStyle </span><span style="color:#0184bc;">= </span><span style="color:#50a14f;">&quot;#ffffff&quot;</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">stroke</span><span style="color:#c18401;">()</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    }
</span><span style="color:#c18401;">}
</span></code></pre>
<ol start="2">
<li>The hinge of rotation of any circle in the system is the center of previous circle. So we update the center of circle based on the center of previous circle and angle it need to rotate.</li>
</ol>
<pre style="background-color:#fafafa;">
<code><span style="color:#a626a4;">class </span><span style="color:#c18401;">Circle {
</span><span style="color:#c18401;">  ...
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  </span><span style="color:#4078f2;">rotate</span><span style="color:#c18401;">(</span><span style="color:#383a42;">parent</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">angle </span><span style="color:#0184bc;">+= </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">rotateSpeed</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">parent</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x </span><span style="color:#0184bc;">+ </span><span style="color:#c18401;">(</span><span style="color:#e45649;">parent</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius </span><span style="color:#0184bc;">+ </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius) </span><span style="color:#0184bc;">* </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">cos</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">angle)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">      </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">parent</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y </span><span style="color:#0184bc;">+ </span><span style="color:#c18401;">(</span><span style="color:#e45649;">parent</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius </span><span style="color:#0184bc;">+ </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius) </span><span style="color:#0184bc;">* </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">sin</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">angle)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">  }
</span><span style="color:#c18401;">}
</span></code></pre>
<ol start="3">
<li>Now let us put it together to create a Spirograph system.</li>
</ol>
<pre style="background-color:#fafafa;">
<code><span style="color:#a626a4;">const </span><span style="color:#986801;">START_RADIUS </span><span style="color:#0184bc;">= </span><span style="color:#986801;">140
</span><span style="color:#383a42;">
</span><span style="color:#a626a4;">class </span><span style="color:#c18401;">System {
</span><span style="color:#c18401;">    </span><span style="color:#4078f2;">constructor</span><span style="color:#c18401;">(</span><span style="color:#383a42;">numCircles</span><span style="color:#c18401;">, </span><span style="color:#383a42;">rotateSpeed</span><span style="color:#c18401;">, </span><span style="color:#383a42;">radiusFallOff</span><span style="color:#c18401;">, </span><span style="color:#383a42;">speedFalloff</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">        </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles </span><span style="color:#0184bc;">= </span><span style="color:#c18401;">[]</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">        </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles </span><span style="color:#0184bc;">= </span><span style="color:#383a42;">numCircles;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">        </span><span style="font-style:italic;color:#a0a1a7;">// calculate the falloff based on rotation speed
</span><span style="color:#c18401;">        </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">fallOff </span><span style="color:#0184bc;">= </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">pow</span><span style="color:#c18401;">(</span><span style="color:#383a42;">rotateSpeed, speedFalloff</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">        </span><span style="font-style:italic;color:#a0a1a7;">// add root circle, which does not rotate
</span><span style="color:#c18401;">        </span><span style="color:#a626a4;">let </span><span style="color:#0184bc;">root = new </span><span style="color:#e45649;">Circle</span><span style="color:#c18401;">(</span><span style="color:#0184bc;">new </span><span style="color:#e45649;">Vector2</span><span style="color:#c18401;">(</span><span style="color:#986801;">0</span><span style="color:#383a42;">, </span><span style="color:#986801;">0</span><span style="color:#c18401;">)</span><span style="color:#383a42;">, </span><span style="color:#986801;">START_RADIUS</span><span style="color:#383a42;">, </span><span style="color:#986801;">0</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">        </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">push</span><span style="color:#c18401;">(</span><span style="color:#0184bc;">root</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">        </span><span style="color:#a626a4;">for </span><span style="color:#c18401;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">i </span><span style="color:#0184bc;">= </span><span style="color:#986801;">1</span><span style="color:#383a42;">; i </span><span style="color:#0184bc;">&lt; </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles</span><span style="color:#383a42;">; i</span><span style="color:#0184bc;">++</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">            </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">prevCircle </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#383a42;">i </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">]</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">            </span><span style="font-style:italic;color:#a0a1a7;">// calculate i-th circle radius using fall off value
</span><span style="color:#c18401;">            </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">circleRadius </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">prevCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">radiusFallOff;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">            </span><span style="font-style:italic;color:#a0a1a7;">// align this i-ith circle on top of previous circle
</span><span style="color:#c18401;">            </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">circleY </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">prevCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y </span><span style="color:#0184bc;">+ </span><span style="color:#e45649;">prevCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">radius </span><span style="color:#0184bc;">+ </span><span style="color:#383a42;">circleRadius;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">            </span><span style="font-style:italic;color:#a0a1a7;">// calculate its final speed
</span><span style="color:#c18401;">            </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">circleRotationSpeed </span><span style="color:#0184bc;">= </span><span style="color:#c18401;">Math</span><span style="color:#383a42;">.</span><span style="color:#e45649;">pow</span><span style="color:#c18401;">(</span><span style="color:#383a42;">rotateSpeed, i </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">) </span><span style="color:#0184bc;">/ </span><span style="color:#383a42;">fallOff;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">            </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">next </span><span style="color:#0184bc;">= new </span><span style="color:#e45649;">Circle</span><span style="color:#c18401;">(</span><span style="color:#0184bc;">new </span><span style="color:#e45649;">Vector2</span><span style="color:#c18401;">(</span><span style="color:#986801;">0</span><span style="color:#383a42;">, circleY</span><span style="color:#c18401;">)</span><span style="color:#383a42;">, circleRadius, circleRotationSpeed</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">            </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles</span><span style="color:#383a42;">.</span><span style="color:#0184bc;">push</span><span style="color:#c18401;">(</span><span style="color:#383a42;">next</span><span style="color:#c18401;">)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">        }
</span><span style="color:#c18401;">    }
</span><span style="color:#c18401;">}
</span></code></pre>
<p>We loop through number of circles, and for every circle we calculate its radius, position and speed and push into circles array.</p>
<ol start="4">
<li>Next we update the system which is fairly straightforward. We loop through the circles and call its rotate function.</li>
</ol>
<pre style="background-color:#fafafa;">
<code><span style="color:#a626a4;">class </span><span style="color:#c18401;">System {
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  ...
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  function </span><span style="color:#4078f2;">update</span><span style="color:#c18401;">() {
</span><span style="color:#c18401;">    </span><span style="color:#a626a4;">for </span><span style="color:#c18401;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">i </span><span style="color:#0184bc;">= </span><span style="color:#986801;">1</span><span style="color:#383a42;">; i </span><span style="color:#0184bc;">&lt; </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles</span><span style="color:#383a42;">; i</span><span style="color:#0184bc;">++</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">        </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#383a42;">i</span><span style="color:#c18401;">]</span><span style="color:#383a42;">.</span><span style="color:#e45649;">rotate</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#383a42;">i </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">])</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    }
</span><span style="color:#c18401;">  }
</span><span style="color:#c18401;">}
</span></code></pre>
<ol start="5">
<li>Now comes the last step i.e Rendering the pattern, which is the path taken by last circle's center in our Spirograph system. To render it, we will store the last circle's center and draw a line from it to current center position.</li>
</ol>
<pre style="background-color:#fafafa;">
<code><span style="color:#a626a4;">class </span><span style="color:#c18401;">System {
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  ...
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  function </span><span style="color:#4078f2;">update</span><span style="color:#c18401;">() {
</span><span style="color:#c18401;">    </span><span style="font-style:italic;color:#a0a1a7;">// save the center of last circle before updating, we will use it in render to draw the line
</span><span style="color:#c18401;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">lastCircle </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">]</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">prevPoint </span><span style="color:#0184bc;">= new </span><span style="color:#e45649;">Vector2</span><span style="color:#c18401;">(</span><span style="color:#e45649;">lastCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x</span><span style="color:#383a42;">, </span><span style="color:#e45649;">lastCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">    </span><span style="color:#a626a4;">for </span><span style="color:#c18401;">(</span><span style="color:#a626a4;">let </span><span style="color:#383a42;">i </span><span style="color:#0184bc;">= </span><span style="color:#986801;">1</span><span style="color:#383a42;">; i </span><span style="color:#0184bc;">&lt; </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles</span><span style="color:#383a42;">; i</span><span style="color:#0184bc;">++</span><span style="color:#c18401;">) {
</span><span style="color:#c18401;">        </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#383a42;">i</span><span style="color:#c18401;">]</span><span style="color:#383a42;">.</span><span style="color:#e45649;">rotate</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#383a42;">i </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">])</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    }
</span><span style="color:#c18401;">  }
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">  function </span><span style="color:#4078f2;">render</span><span style="color:#c18401;">() {
</span><span style="color:#c18401;">    </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">lastCircle </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">circles[</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">numCircles </span><span style="color:#0184bc;">- </span><span style="color:#986801;">1</span><span style="color:#c18401;">]</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#c18401;">strokeStyle </span><span style="color:#0184bc;">= </span><span style="color:#50a14f;">&quot;white&quot;</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#c18401;">lineWidth </span><span style="color:#0184bc;">= </span><span style="color:#986801;">1</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">beginPath</span><span style="color:#c18401;">()</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">
</span><span style="color:#c18401;">    </span><span style="font-style:italic;color:#a0a1a7;">// draw the line from last circle&#39;s previous center to current center
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">moveTo</span><span style="color:#c18401;">(</span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">prevPoint</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x</span><span style="color:#383a42;">, </span><span style="color:#e45649;">this</span><span style="color:#383a42;">.</span><span style="color:#c18401;">prevPoint</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">lineTo</span><span style="color:#c18401;">(</span><span style="color:#e45649;">lastCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">x</span><span style="color:#383a42;">, </span><span style="color:#e45649;">lastCircle</span><span style="color:#383a42;">.</span><span style="color:#c18401;">y)</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">    </span><span style="color:#e45649;">ctx</span><span style="color:#383a42;">.</span><span style="color:#e45649;">stroke</span><span style="color:#c18401;">()</span><span style="color:#383a42;">;
</span><span style="color:#c18401;">  }
</span><span style="color:#c18401;">}
</span></code></pre>
<p>Now tying up everything,</p>
<pre style="background-color:#fafafa;">
<code><span style="color:#383a42;">
</span><span style="color:#a626a4;">function </span><span style="color:#4078f2;">main</span><span style="color:#383a42;">() {
</span><span style="color:#383a42;">  </span><span style="font-style:italic;color:#a0a1a7;">// taking example values
</span><span style="color:#383a42;">  </span><span style="color:#a626a4;">let </span><span style="color:#383a42;">system  </span><span style="color:#0184bc;">= </span><span style="color:#e45649;">System</span><span style="color:#383a42;">(</span><span style="color:#986801;">10</span><span style="color:#383a42;">, </span><span style="color:#986801;">3</span><span style="color:#383a42;">, </span><span style="color:#0184bc;">-</span><span style="color:#986801;">8</span><span style="color:#383a42;">, </span><span style="color:#986801;">4</span><span style="color:#383a42;">);
</span><span style="color:#383a42;">
</span><span style="color:#383a42;">  loop {
</span><span style="color:#383a42;">    </span><span style="color:#e45649;">system</span><span style="color:#383a42;">.</span><span style="color:#e45649;">update</span><span style="color:#383a42;">();
</span><span style="color:#383a42;">    </span><span style="color:#e45649;">system</span><span style="color:#383a42;">.</span><span style="color:#e45649;">render</span><span style="color:#383a42;">();
</span><span style="color:#383a42;">  }
</span><span style="color:#383a42;">}
</span></code></pre>
<p>That's all on this, I hope you enjoyed this post. If you're looking for more tech content, be sure to check out my <a href="/">other</a> blog posts or subscribe below.</p>
<h3>References</h3>
<ol>
<li><a href="https://softologyblog.wordpress.com/2017/02/27/fractal-spirographs/">https://softologyblog.wordpress.com/2017/02/27/fractal-spirographs/</a></li>
<li><a href="https://benice-equation.blogspot.com.au/2012/01/fractal-spirograph.html">https://benice-equation.blogspot.com.au/2012/01/fractal-spirograph.html</a></li>
</ol>
<style>canvas{display:block;margin:auto;}#canvas-shape{position:absolute;top:0;left:calc(50% - 300px);}#gui-main{position:absolute;top:0;right:0;}@media only screen and (max-width:740px){canvas{width:calc(100vw - 2em);}#canvas-shape{left:0;}}</style>
</div>
<form id="subscribe-form" action="https://tinyletter.com/deep110" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/deep110', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
<label for="tlemail">
<h2>Get new blogs sent to you</h2>
</label>
<span id="tl-email-describe">
Subscribe to my blog on programming, computer graphics, and few other topics. Published once a month.
</span>
<div style="margin-top: 8px;">
<input type="text" name="email" placeholder="Your email address" id="tlemail"/>
<input type="hidden" value="1" name="embed"/>
<button type="submit" name="subscribe" id="btn-subscribe">Subscribe</button>
</div>
</form>
<div class="post-navigation">
<a href="https://deep110.github.io/posts/blogs/2022-06-25-terrain-editor-marching-cubes.html">←&nbsp;Prev Post</a>
</div>
<div>
<script src="https://utteranc.es/client.js" repo="deep110/deep110.github.io" issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async></script>
</div>
</article>
</div>
</div>
<footer class="site-footer">
<div class="wrapper">
<a class="footer-icon icon" href="https://github.com/deep110" aria-label="Github">
<svg viewBox="0 0 438.55 438.55">
<path d="m409.13 114.57c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.06-29.408-39.781 0-76.472 9.804-110.06 29.408-33.596 19.605-60.192 46.204-79.8 79.8-19.605 33.595-29.408 70.281-29.408 110.06 0 47.78 13.94 90.745 41.827 128.91 27.884 38.164 63.906 64.572 108.06 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417-.098-9.709-.144-18.179-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289s4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136s11.704-.476 16.274-1.423c4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.07-79.226 27.88-38.161 41.825-81.126 41.825-128.91-.01-39.771-9.818-76.454-29.414-110.05z"/>
</svg>
</a>
<a class="footer-icon icon" href="https://www.linkedin.com/in/deepankar-agrawal-318aab96/" aria-label="LinkedIn">
<svg enable-background="new 0 0 486.392 486.392" version="1.1" viewBox="0 0 486.39 486.39">
<path d="m243.2 0c-134.3 0-243.2 108.89-243.2 243.2s108.89 243.2 243.2 243.2 243.2-108.89 243.2-243.2c0-134.34-108.89-243.2-243.2-243.2zm-60.799 360.99h-60.799v-212.8h60.799v212.8zm-28.515-225.84c-15.747 0-28.484-12.768-28.484-28.515s12.768-28.515 28.484-28.515c15.747 0.03 28.515 12.798 28.515 28.515 0 15.747-12.768 28.515-28.515 28.515zm241.31 225.84h-60.799v-131.57c0-15.413-4.408-26.204-23.347-26.204-31.403 0-37.452 26.204-37.452 26.204v131.57h-60.799v-212.8h60.799v20.337c8.694-6.657 30.399-20.307 60.799-20.307 19.699 0 60.799 11.795 60.799 83.051v129.72z"/>
</svg>
</a>
<a class="footer-icon icon" href="https://deep110.github.io/rss.xml" aria-label="RSS">
<svg viewBox="0 0 48 48">
<path fill-rule="evenodd" clip-rule="evenodd" d="M24 0C10.7452 0 0 10.7452 0 24C0 37.2548 10.7452 48 24 48C37.2548 48 48 37.2548 48 24C48 10.7452 37.2548 0 24 0ZM17.6002 33.6C15.833 33.6 14.4002 32.1672 14.4002 30.4C14.4002 28.6328 15.833 27.2 17.6002 27.2C19.3674 27.2 20.8002 28.6328 20.8002 30.4C20.8002 32.1672 19.3674 33.6 17.6002 33.6ZM36.8 33.6C36.8 21.2488 26.7513 11.2 14.4002 11.2V15.4664C24.3993 15.4664 32.5336 23.6008 32.5336 33.6H36.8ZM14.4 18.6664C22.6343 18.6664 29.3334 25.3656 29.3334 33.6H25.0671C25.0671 27.7184 20.2815 22.9336 14.4 22.9336V18.6664Z"/>
</svg>
</a>
<a class="footer-icon icon" href="mailto:deepankar11093@gmail.com" aria-label="Mail">
<svg enable-background="new 0 0 299.997 299.997" viewBox="0 0 299.997 299.997"><path d="m149.996 0c-82.839 0-149.995 67.158-149.995 149.997 0 82.837 67.156 150 149.995 150s150-67.163 150-150c0-82.839-67.161-149.997-150-149.997zm.003 52.686 88.763 55.35h-177.526zm89.869 143.737h-.009c0 8.878-7.195 16.072-16.072 16.072h-147.576c-8.878 0-16.072-7.195-16.072-16.072v-84.865c0-.939.096-1.852.252-2.749l84.808 52.883c.104.065.215.109.322.169.112.062.226.122.34.179.599.309 1.216.558 1.847.721.065.018.13.026.195.041.692.163 1.393.265 2.093.265h.005.01c.7 0 1.401-.099 2.093-.265.065-.016.13-.023.195-.041.63-.163 1.245-.412 1.847-.721.114-.057.228-.117.34-.179.106-.06.218-.104.322-.169l84.808-52.883c.156.897.252 1.808.252 2.749z"/></svg>
</a>
</div>
</footer>
<script type="text/javascript" src="https://deep110.github.io/assets/js/base.js"></script>
<script defer type="text/javascript" src="https://deep110.github.io/assets/js/lib/lil-gui.min.js"></script>
<script defer type="text/javascript" src="https://deep110.github.io/assets/js/extras/fractal-spirographs.js"></script>
<link rel="stylesheet" href="https://deep110.github.io/assets/css/katex.min.css"></script>
</body>
</html>